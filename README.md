# fix-diff-go

A Go library that fix the incorrect lines number `@@ -a,b +c,d @@` in unified diff generated by AI.

## API & Usage

The library exposes a single primary function.

```go
func Fix(diffContent, originalContent string) (string, error)
```

### Parameters

- `diffContent` (string): The content of the malformed or broken unified diff.
- `originalContent` (string): The complete, original source content that the diff should be applied to.

### Returns

- A `string` containing the corrected, clean unified diff.
- An `error` if the diff is unparsable or if a hunk's content cannot be located within the original source.

### Example

```go
package main

import (
	"fmt"
	"log"

	"github.com/sokinpui/fix-diff-go"
)

func main() {
	originalFile := `line 1
line 2
line 3
line 4: A line to be removed.
line 5
line 6
line 7
line 8: Some more original text.
line 9
line 10
`

	// This diff has an incorrect line number in the hunk header (e.g., "@@ -1,5 +1,5 @@")
	// but the content of the hunk is correct. Standard tools would fail.
	brokenDiff := `--- a/original.txt
+++ b/modified.txt
@@ -1,5 +1,5 @@
 line 2
 line 3
-line 4: A line to be removed.
+line 4: A line that was added.
 line 5
 line 6
`

	fixedDiff, err := fixdiff.Fix(brokenDiff, originalFile)
	if err != nil {
		log.Fatalf("Failed to fix diff: %v", err)
	}

	fmt.Println("Original Broken Diff:")
	fmt.Println(brokenDiff)
	fmt.Println("\n---")
	fmt.Println("\nFixed Diff (with correct line numbers):")
	fmt.Println(fixedDiff)
}
```

#### Output of Example

```text
Original Broken Diff:
--- a/original.txt
+++ b/modified.txt
@@ -1,5 +1,5 @@
 line 2
 line 3
-line 4: A line to be removed.
+line 4: A line that was added.
 line 5
 line 6

---

Fixed Diff (with correct line numbers):
--- a/original.txt
+++ b/modified.txt
@@ -1,7 +1,7 @@
 line 1
 line 2
 line 3
-line 4: A line to be removed.
+line 4: A line that was added.
 line 5
 line 6
 line 7
```
